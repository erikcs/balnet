% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/balnet.R
\name{balnet}
\alias{balnet}
\title{Pathwise estimation of covariate balancing propensity scores.}
\usage{
balnet(
  X,
  W,
  target = c("ATE", "ATT", "treated", "control"),
  sample.weights = NULL,
  nlambda = 100L,
  lambda.min.ratio = 0.01,
  lambda = NULL,
  penalty.factor = NULL,
  groups = NULL,
  alpha = 1,
  standardize = TRUE,
  thresh = 1e-07,
  maxit = as.integer(1e+05),
  verbose = FALSE,
  num.threads = 1L,
  ...
)
}
\arguments{
\item{X}{A numeric matrix or data frame with pre-treatment covariates.}

\item{W}{Treatment vector (0: control, 1: treated).}

\item{target}{The target estimand. Default is ATE.}

\item{sample.weights}{Optional sample weights. If \code{NULL} (default), then each unit receives the same weight.}

\item{nlambda}{Number of values for \code{lambda}, if generated automatically. Default is 100.}

\item{lambda.min.ratio}{Ratio between smallest and largest value of lambda. Default is 1e-2.}

\item{lambda}{Optional \code{lambda} sequence. By default, the \code{lambda} sequence is constructed automatically using \code{nlambda} and \code{lambda.min.ratio}.}

\item{penalty.factor}{Penalty factor per feature. Default is 1 (i.e, each feature recieves the same penalty).}

\item{groups}{An optional list of group indices for group penalization.}

\item{alpha}{Elastic net mixing parameter. Default is 1 (lasso). 0 is ridge.}

\item{standardize}{Whether to standardize the input matrix. This should only be set to \code{FALSE} if
\code{X} already has zero-mean columns with unit variance; for \code{target = "ATT"}, standardization
should be based on the treated group. Alternatively, set to \code{"inplace"} to overwrite \code{X} with
its standardized version, avoiding an additional copy.}

\item{thresh}{Coordinate descent convergence tolerance, default 1e-7.}

\item{maxit}{Maximum total number of coordinate descent iterations, default is 1e5.}

\item{verbose}{Whether to display information during fitting. Default is \code{FALSE}.}

\item{num.threads}{Number of threads, default is 1.}

\item{...}{Additional internal arguments passed to solver.}
}
\value{
A fit balnet object.
}
\description{
Fits regularized logistic regression models using covariate balancing loss
functions, targeting the ATE, ATT, or treated/control means.
}
\examples{
\donttest{
n <- 100
p <- 25
X <- matrix(rnorm(n * p), n, p)
W <- rbinom(n, 1, 1 / (1 + exp(1 - X[, 1])))

# Fit an ATE model.
fit <- balnet(X, W)

# Print path summary.
print(fit)

# Plot path diagnostics.
plot(fit)

# Plot covariate imbalance at the end of the path (closest to lambda = 0).
plot(fit, lambda = 0)

# Predict propensity scores.
pp <- predict(fit, X)

# Extract coefficients.
coefs <- coef(fit)
}

}
