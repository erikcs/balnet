% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{col_stats}
\alias{col_stats}
\title{Compute weighted column means and standard deviations.}
\usage{
col_stats(X, weights = NULL, compute_sd = FALSE)
}
\arguments{
\item{X}{A \code{n * p} numeric R matrix.}

\item{weights}{A \code{n * L} numeric weight matrix, or an \code{n}-vector.}

\item{compute_sd}{Whether to return the standard deviation.}
}
\value{
\code{L * p} matrices of column stats.
}
\description{
For X column \code{x}, and weight column \code{w}, this function computes
\eqn{\mu = \frac{\sum_{i}^{n} w_i x_i}{\sum_{i}^{n} w_i}} and
\eqn{\sigma^2 = \frac{\sum_{i}^{n} w_i (x_i - \mu)^2}{\sum_{i}^{n} w_i}.}
}
\details{
Simply calls into Eigen to do the following at a slight speed advantage
\code{col.means <- crossprod(weights, X) / colSums(weights);}
\code{col.vars <- crossprod(weights, X^2) / colSums(weights) - col.means^2}
}
\keyword{internal}
